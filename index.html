<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç®±æ ¹é§…ä¼ã‚³ãƒ¼ã‚¹ã‚¬ã‚¤ãƒ‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* ãƒ”ãƒ³ã®æ³¢ç´‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
      @keyframes ping-slow {
        75%, 100% {
          transform: scale(2);
          opacity: 0;
        }
      }
      .animate-ping-slow {
        animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;
      }
      
      /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
      .modal-enter { opacity: 0; transform: scale(0.95); }
      .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity 300ms ease-out, transform 300ms ease-out; }
      .modal-exit { opacity: 1; transform: scale(1); }
      .modal-exit-active { opacity: 0; transform: scale(0.95); transition: opacity 200ms ease-in, transform 200ms ease-in; }

      /* ãƒãƒƒãƒ—ç”»åƒã®é¸æŠä¸å¯è¨­å®š */
      .no-select {
        user-select: none;
        -webkit-user-drag: none;
      }

      /* ãƒãƒƒãƒ—ã‚ºãƒ¼ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
      .map-container {
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        transform-origin: center center;
      }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-gray-100 text-gray-900 font-sans antialiased">
    
    <!-- Header -->
    <header class="bg-red-700 shadow-md sticky top-0 z-50">
      <div class="container mx-auto px-4 h-16 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="bg-white p-1.5 rounded text-red-700 font-bold">
            <!-- Flag Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" x2="4" y1="22" y2="15"/></svg>
          </div>
          <h1 class="text-xl font-bold text-white">é§…ä¼ã‚³ãƒ¼ã‚¹ã‚¬ã‚¤ãƒ‰</h1>
        </div>
        <button class="text-xs sm:text-sm bg-white text-red-700 px-4 py-2 rounded-full font-bold hover:bg-red-50 transition shadow-sm">
          ã‚³ãƒ¼ã‚¹è©³ç´°PDF
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-2 py-6 sm:p-6 flex justify-center">
      <div class="bg-white rounded-xl shadow-xl overflow-hidden w-full max-w-5xl border border-gray-200">
        
        <!-- Title Area -->
        <div class="p-4 border-b border-gray-100 bg-gray-50">
          <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
            <span class="w-2 h-6 bg-red-600 rounded-sm inline-block"></span>
            å¾€è·¯ãƒ»åŒºé–“ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒãƒƒãƒ—
          </h2>
          <p class="text-sm text-gray-500 mt-1 ml-4">
            åœ°å›³ä¸Šã®ãƒ”ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å„åœ°ç‚¹ã®åŒºé–“æƒ…å ±ã‚„è¦‹ã©ã“ã‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
          </p>
        </div>

        <!-- Section Selector -->
        <div class="p-4 border-b border-gray-100 bg-white">
          <div class="flex flex-wrap gap-2 items-center">
            <span class="text-sm font-semibold text-gray-700 mr-2">åŒºé–“é¸æŠ:</span>
            <button onclick="zoomToSection('all')" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 bg-red-600 text-white border-red-600" data-section="all">
              å…¨ä½“è¡¨ç¤º
            </button>
            <button onclick="zoomToSection(0)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="0">
              START
            </button>
            <button onclick="zoomToSection(1)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="1">
              1åŒºâ†’2åŒº
            </button>
            <button onclick="zoomToSection(2)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="2">
              2åŒºâ†’3åŒº
            </button>
            <button onclick="zoomToSection(3)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="3">
              3åŒºâ†’4åŒº
            </button>
            <button onclick="zoomToSection(4)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="4">
              4åŒºâ†’5åŒº
            </button>
            <button onclick="zoomToSection(5)" class="section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50" data-section="5">
              FINISH
            </button>
          </div>
        </div>

        <!-- Map Area -->
        <div id="map-viewport" class="relative w-full bg-slate-100 overflow-hidden" style="height: 600px;">

          <div id="map-container" class="map-container w-full h-full relative">
            <!-- åœ°å›³ç”»åƒ -->
            <!--
                 æ³¨æ„: map.jpg ãŒ index.html ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
                 ç”»åƒãŒãªã„å ´åˆã¯ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
            -->
            <img
              id="map-image"
              src="./map.jpg"
              alt="é§…ä¼ãƒãƒƒãƒ—"
              onerror="this.style.display='none'; document.getElementById('img-placeholder').style.display='flex';"
              class="w-full h-auto block no-select"
            />

            <!-- ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ -->
            <div id="img-placeholder" class="hidden w-full h-96 bg-gray-200 flex-col items-center justify-center text-gray-500">
              <p class="font-bold text-lg">ãƒãƒƒãƒ—ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>
              <p class="text-sm">ãƒ•ã‚©ãƒ«ãƒ€å†…ã« "map.jpg" ã‚’é…ç½®ã—ã¦ãã ã•ã„ã€‚</p>
            </div>

            <!-- ãƒ”ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div id="pins-layer" class="absolute inset-0 w-full h-full">
              <!-- JSã§ã“ã“ã«ãƒ”ãƒ³ãŒç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>
          </div>

        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="text-center text-gray-500 text-sm py-6 border-t border-gray-200 mt-8">
      &copy; 2024 Hakone Ekiden Guide - Interactive Map
    </footer>

    <!-- Modal Overlay -->
    <div id="modal-backdrop" class="fixed inset-0 z-[100] flex items-center justify-center p-4 hidden">
      <!-- èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹ -->
      <div class="absolute inset-0 bg-black/70 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
      
      <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«æœ¬ä½“ -->
      <div id="modal-content" class="relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden transform transition-all">
        
        <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ -->
        <button onclick="closeModal()" class="absolute top-3 right-3 z-10 bg-black/30 hover:bg-black/50 text-white p-2 rounded-full backdrop-blur transition border border-white/20">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>

        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ -->
        <div class="h-48 sm:h-56 bg-gray-200 relative">
          <img id="modal-image" src="" alt="" class="w-full h-full object-cover" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>
          <div class="absolute bottom-0 left-0 w-full p-5 text-white">
            <span id="modal-tag" class="bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider mb-2 inline-block border border-white/20">
              Check Point
            </span>
            <h3 id="modal-title" class="text-2xl font-bold leading-tight drop-shadow-md">Title</h3>
          </div>
        </div>

        <!-- æœ¬æ–‡ -->
        <div class="p-6 bg-white">
          <div class="flex items-start gap-3 mb-4">
            <div class="mt-1 min-w-[20px] text-red-600">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
            </div>
            <p id="modal-desc" class="text-gray-700 leading-relaxed text-sm sm:text-base">
              Description goes here.
            </p>
          </div>
          
          <div class="mt-6 pt-4 border-t border-gray-100 text-right">
            <button onclick="closeModal()" class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-2.5 px-8 rounded-lg text-sm transition">
              é–‰ã˜ã‚‹
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // ==========================================
      // ğŸ“ ãƒ”ãƒ³ã®ãƒ‡ãƒ¼ã‚¿å®šç¾©
      // ==========================================
      const PINS = [
        {
          // å³ä¸Šï¼šã‚¹ã‚¿ãƒ¼ãƒˆï¼ˆå¤§æ‰‹ç”ºï¼‰
          top: 10,
          left: 78,
          title: 'ã‚¹ã‚¿ãƒ¼ãƒˆï¼šå¤§æ‰‹ç”º',
          tag: 'START',
          image: 'https://images.unsplash.com/photo-1558350277-f0c8019c4a21?auto=format&fit=crop&q=80&w=600',
          description: 'ã€å¾€è·¯ã‚¹ã‚¿ãƒ¼ãƒˆã€‘èª­å£²æ–°èç¤¾å‰ã€‚1æœˆ2æ—¥åˆå‰8æ™‚00åˆ†ã€ä¸€æ–‰ã«ã‚¹ã‚¿ãƒ¼ãƒˆã®å·ç ²ãŒé³´ã‚ŠéŸ¿ãã¾ã™ã€‚'
        },
        {
          // ä¸­å¤®å³å¯„ã‚Šï¼šé¶´è¦‹ä¸­ç¶™æ‰€
          top: 38,
          left: 62,
          title: '1åŒºâ†’2åŒºï¼šé¶´è¦‹ä¸­ç¶™æ‰€',
          tag: '1åŒº â†’ 2åŒº',
          image: 'https://images.unsplash.com/photo-1461896836934-ffe607ba8211?auto=format&fit=crop&q=80&w=600',
          description: 'ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ©ãƒ³ãƒŠãƒ¼ãŒé›†ã†1åŒºã‹ã‚‰ã€å„æ ¡ã®ã‚¨ãƒ¼ã‚¹ãŒå¾…ã¤ã€ŒèŠ±ã®2åŒºã€ã¸ã®ã‚¿ã‚¹ã‚­ãƒªãƒ¬ãƒ¼ã€‚ç¹°ã‚Šä¸Šã’ã‚¹ã‚¿ãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒã‚‚ç”Ÿã¾ã‚Œã‚‹å ´æ‰€ã§ã™ã€‚'
        },
        {
          // ä¸­å¤®ï¼šæˆ¸å¡šä¸­ç¶™æ‰€
          top: 56,
          left: 48,
          title: '2åŒºâ†’3åŒºï¼šæˆ¸å¡šä¸­ç¶™æ‰€',
          tag: '2åŒº â†’ 3åŒº',
          image: 'https://images.unsplash.com/photo-1535132018013-5431d3972707?auto=format&fit=crop&q=80&w=600',
          description: 'æ¨©å¤ªå‚ã‚’è¶ŠãˆãŸå…ˆã«ã‚ã‚‹ä¸­ç¶™æ‰€ã€‚ã‚¨ãƒ¼ã‚¹åŒºé–“ã®æ¿€èµ°ã‚’çµ‚ãˆãŸé¸æ‰‹ãŸã¡ãŒã€æ¹˜å—ã‚’ç›®æŒ‡ã™3åŒºã¸ã‚¿ã‚¹ã‚­ã‚’ã¤ãªãã¾ã™ã€‚'
        },
        {
          // ä¸‹ä¸­å¤®ï¼šå¹³å¡šä¸­ç¶™æ‰€
          top: 78,
          left: 42,
          title: '3åŒºâ†’4åŒºï¼šå¹³å¡šä¸­ç¶™æ‰€',
          tag: '3åŒº â†’ 4åŒº',
          image: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&q=80&w=600',
          description: 'æ¹˜å—ã®æµ·æ²¿ã„ã‚’é§†ã‘æŠœã‘ãŸå¾Œã®ç¬¬3ä¸­ç¶™æ‰€ã€‚æµ·é¢¨ã¨æ—¥å·®ã—ã®å½±éŸ¿ã‚’å—ã‘ã‚„ã™ã„ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚'
        },
        {
          // å·¦ä¸‹ï¼šå°ç”°åŸä¸­ç¶™æ‰€
          top: 72,
          left: 22,
          title: '4åŒºâ†’5åŒºï¼šå°ç”°åŸä¸­ç¶™æ‰€',
          tag: '4åŒº â†’ 5åŒº',
          image: 'https://images.unsplash.com/photo-1519115967240-914b4490849e?auto=format&fit=crop&q=80&w=600',
          description: 'å¾€è·¯æœ€å¾Œã®ä¸­ç¶™æ‰€ã€‚ã“ã“ã‹ã‚‰æ¨™é«˜å·®800mä»¥ä¸Šã‚’é§†ã‘ä¸ŠãŒã‚‹ã€Œå±±ä¸Šã‚Šã€ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆã¸ã‚¿ã‚¹ã‚­ãŒè¨—ã•ã‚Œã¾ã™ã€‚'
        },
        {
          // å·¦ä¸‹å¥¥ï¼šãƒ•ã‚£ãƒ‹ãƒƒã‚·ãƒ¥ï¼ˆç®±æ ¹ï¼‰
          top: 85,
          left: 12,
          title: 'å¾€è·¯ãƒ•ã‚£ãƒ‹ãƒƒã‚·ãƒ¥ï¼šèŠ¦ãƒæ¹–',
          tag: 'FINISH',
          image: 'https://images.unsplash.com/photo-1528366220965-3091b15608f4?auto=format&fit=crop&q=80&w=600',
          description: 'ã€å¾€è·¯ã‚´ãƒ¼ãƒ«ã€‘éé…·ãªå±±é“ã‚’ç™»ã‚Šãã£ãŸå…ˆã€èŠ¦ãƒæ¹–ç•”ã®ã‚´ãƒ¼ãƒ«åœ°ç‚¹ã€‚å¾€è·¯å„ªå‹ã®æ „å† ã¨ã€ç¿Œæ—¥ã®å¾©è·¯ã«å‘ã‘ãŸã‚¿ã‚¤ãƒ å·®ãŒæ±ºã¾ã‚Šã¾ã™ã€‚'
        }
      ];

      // ==========================================
      // ğŸ” åŒºé–“ã”ã¨ã®ã‚ºãƒ¼ãƒ è¨­å®š
      // ==========================================
      const SECTION_ZOOM_SETTINGS = [
        // ã‚¹ã‚¿ãƒ¼ãƒˆåœ°ç‚¹å‘¨è¾º
        { centerX: 78, centerY: 10, zoom: 2.5 },
        // é¶´è¦‹ä¸­ç¶™æ‰€å‘¨è¾ºï¼ˆ1åŒºâ†’2åŒºï¼‰
        { centerX: 62, centerY: 38, zoom: 2.5 },
        // æˆ¸å¡šä¸­ç¶™æ‰€å‘¨è¾ºï¼ˆ2åŒºâ†’3åŒºï¼‰
        { centerX: 48, centerY: 56, zoom: 2.5 },
        // å¹³å¡šä¸­ç¶™æ‰€å‘¨è¾ºï¼ˆ3åŒºâ†’4åŒºï¼‰
        { centerX: 42, centerY: 78, zoom: 2.5 },
        // å°ç”°åŸä¸­ç¶™æ‰€å‘¨è¾ºï¼ˆ4åŒºâ†’5åŒºï¼‰
        { centerX: 22, centerY: 72, zoom: 2.5 },
        // ãƒ•ã‚£ãƒ‹ãƒƒã‚·ãƒ¥åœ°ç‚¹å‘¨è¾º
        { centerX: 12, centerY: 85, zoom: 2.5 }
      ];

      // ==========================================
      // ğŸ› ï¸ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
      // ==========================================

      let currentZoom = 1;
      let currentPanX = 0;
      let currentPanY = 0;

      document.addEventListener('DOMContentLoaded', () => {
        renderPins();
      });

      function renderPins() {
        const layer = document.getElementById('pins-layer');
        layer.innerHTML = '';

        PINS.forEach((pin, index) => {
          const el = document.createElement('div');
          
          // é…ç½®ã‚¹ã‚¿ã‚¤ãƒ«
          // translate(-50%, -100%) ã«ã‚ˆã£ã¦ã€åº§æ¨™(top/left)ãŒãƒ”ãƒ³ã®ã€Œå…ˆç«¯ï¼ˆä¸‹ï¼‰ã€ã«æ¥ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
          el.className = 'absolute cursor-pointer group z-10 flex flex-col items-center';
          el.style.top = pin.top + '%';
          el.style.left = pin.left + '%';
          el.style.transform = 'translate(-50%, -100%)'; // ãƒ”ãƒ³ã®å…ˆç«¯ã‚’åº§æ¨™ã«åˆã‚ã›ã‚‹

          // ã‚¹ã‚¿ã‚¤ãƒ«åˆ¤å®š
          const isStart = pin.tag === 'START';
          const isFinish = pin.tag === 'FINISH';
          const isSpecial = isStart || isFinish;

          const mainColor = isSpecial ? 'bg-slate-900' : 'bg-red-600';
          const hoverColor = isSpecial ? 'group-hover:bg-slate-800' : 'group-hover:bg-red-700';
          const ringColor = isSpecial ? 'bg-slate-400' : 'bg-red-400';

          // ã‚¢ã‚¤ã‚³ãƒ³SVG
          const flagIcon = `<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M5 21h2v-6h11l-2.5-4L18 7H7V3H5v18z"/></svg>`;
          
          // HTMLç”Ÿæˆ
          // SVGã§ãƒ”ãƒ³ã‚’æç”»ã—ã€å…ˆç«¯ãŒä¸‹ã«æ¥ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
          el.innerHTML = `
            <!-- æ³¢ç´‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ -->
            <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-12 h-12 ${ringColor} rounded-full animate-ping-slow opacity-50 pointer-events-none"></div>
            
            <!-- å¹ãå‡ºã—å‹ãƒ”ãƒ³ -->
            <div class="relative transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-2 origin-bottom">
              <div class="flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full shadow-lg border-2 border-white ${mainColor} ${hoverColor} text-white transition-colors">
                ${isSpecial ? flagIcon : `<span class="font-bold text-sm sm:text-base font-mono">${index}</span>`}
              </div>
              <!-- ãƒ”ãƒ³ã®ä¸‰è§’å½¢ï¼ˆã—ã£ã½ï¼‰ -->
              <div class="w-0 h-0 
                          border-l-[8px] border-l-transparent 
                          border-r-[8px] border-r-transparent 
                          border-t-[10px] ${isSpecial ? 'border-t-slate-900' : 'border-t-red-600'}
                          mx-auto drop-shadow-sm"></div>
            </div>

            <!-- ãƒ›ãƒãƒ¼æ™‚ã®ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ— -->
            <div class="absolute bottom-full mb-2 hidden group-hover:block whitespace-nowrap z-20">
              <div class="bg-gray-900 text-white text-xs font-bold px-3 py-1.5 rounded shadow-xl transform transition-all">
                ${pin.title}
                <div class="absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-gray-900"></div>
              </div>
            </div>
          `;

          // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
          el.addEventListener('click', (e) => {
            e.stopPropagation();
            openModal(pin);
          });

          layer.appendChild(el);
        });
      }

      function openModal(pin) {
        const backdrop = document.getElementById('modal-backdrop');
        const content = document.getElementById('modal-content');
        const tagEl = document.getElementById('modal-tag');

        // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ
        document.getElementById('modal-image').src = pin.image;
        document.getElementById('modal-title').textContent = pin.title;
        document.getElementById('modal-desc').textContent = pin.description;
        tagEl.textContent = pin.tag;

        // ã‚¿ã‚°ã®è‰²åˆ†ã‘
        if (pin.tag === 'START' || pin.tag === 'FINISH') {
          tagEl.className = 'bg-slate-800 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider mb-2 inline-block border border-white/20';
        } else {
          tagEl.className = 'bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider mb-2 inline-block border border-white/20';
        }

        // è¡¨ç¤ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        backdrop.classList.remove('hidden');
        content.classList.remove('modal-exit', 'modal-exit-active');
        content.classList.add('modal-enter');
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ã§ã‚¯ãƒ©ã‚¹é©ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ãšã‚‰ã™
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            content.classList.add('modal-enter-active');
            content.classList.remove('modal-enter');
          });
        });
      }

      function closeModal() {
        const backdrop = document.getElementById('modal-backdrop');
        const content = document.getElementById('modal-content');

        content.classList.add('modal-exit');
        content.classList.remove('modal-enter-active');

        requestAnimationFrame(() => {
          content.classList.add('modal-exit-active');
          content.classList.remove('modal-exit');
        });

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«éè¡¨ç¤º
        setTimeout(() => {
          backdrop.classList.add('hidden');
        }, 200);
      }

      // ==========================================
      // ğŸ” åŒºé–“ã‚ºãƒ¼ãƒ æ©Ÿèƒ½
      // ==========================================

      function zoomToSection(sectionIndex) {
        const mapContainer = document.getElementById('map-container');
        const viewport = document.getElementById('map-viewport');

        // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
        updateActiveButton(sectionIndex);

        if (sectionIndex === 'all') {
          // å…¨ä½“è¡¨ç¤ºã«ãƒªã‚»ãƒƒãƒˆ
          currentZoom = 1;
          currentPanX = 0;
          currentPanY = 0;
          mapContainer.style.transform = `scale(${currentZoom}) translate(${currentPanX}px, ${currentPanY}px)`;
          return;
        }

        // åŒºé–“ã®è¨­å®šã‚’å–å¾—
        const setting = SECTION_ZOOM_SETTINGS[sectionIndex];
        if (!setting) return;

        currentZoom = setting.zoom;

        // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®ä¸­å¿ƒã«æŒ‡å®šåº§æ¨™ãŒæ¥ã‚‹ã‚ˆã†ã«è¨ˆç®—
        const viewportRect = viewport.getBoundingClientRect();
        const mapImage = document.getElementById('map-image');
        const mapRect = mapImage.getBoundingClientRect();

        // ãƒãƒƒãƒ—ä¸Šã®åº§æ¨™ï¼ˆ%ï¼‰ã‚’ãƒ”ã‚¯ã‚»ãƒ«ã«å¤‰æ›
        const targetX = (setting.centerX / 100) * mapRect.width;
        const targetY = (setting.centerY / 100) * mapRect.height;

        // ã‚ºãƒ¼ãƒ å¾Œã®ãƒãƒƒãƒ—ã‚µã‚¤ã‚º
        const zoomedWidth = mapRect.width * currentZoom;
        const zoomedHeight = mapRect.height * currentZoom;

        // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆä¸­å¿ƒã¸ã®ç§»å‹•é‡ã‚’è¨ˆç®—
        const viewportCenterX = viewportRect.width / 2;
        const viewportCenterY = viewportRect.height / 2;

        // ã‚ºãƒ¼ãƒ é©ç”¨å¾Œã®åº§æ¨™ä½ç½®
        const scaledTargetX = targetX * currentZoom;
        const scaledTargetY = targetY * currentZoom;

        // ãƒ‘ãƒ³é‡ã‚’è¨ˆç®—ï¼ˆãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆä¸­å¿ƒ - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆä½ç½®ï¼‰
        currentPanX = (viewportCenterX - scaledTargetX) / currentZoom;
        currentPanY = (viewportCenterY - scaledTargetY) / currentZoom;

        // å¤‰æ›ã‚’é©ç”¨
        mapContainer.style.transform = `scale(${currentZoom}) translate(${currentPanX}px, ${currentPanY}px)`;
      }

      function updateActiveButton(activeSection) {
        const buttons = document.querySelectorAll('.section-btn');
        buttons.forEach(btn => {
          const section = btn.dataset.section;
          if (section === String(activeSection)) {
            btn.className = 'section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 bg-red-600 text-white border-red-600';
          } else {
            btn.className = 'section-btn px-4 py-2 text-xs font-bold rounded-full transition-all border-2 border-gray-300 bg-white text-gray-700 hover:border-red-400 hover:bg-red-50';
          }
        });
      }
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>